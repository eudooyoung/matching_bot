<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8"/>
    <title>MatchingBot | ì´ë ¥ì„œ ëª©ë¡</title>

    <!-- âœ… Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" th:href="@{/css/layout.css}"/>

    <style>
        .card {
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.06);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .card-text {
            font-size: 1rem;
            color: #555;
        }

        .meta-text {
            font-size: 0.9rem;
            color: #777;
        }
    </style>

    <!-- head ì•ˆì— ì§ì ‘ ì‚½ì…í•˜ì—¬ JS inlineìœ¼ë¡œ ì‹¤í–‰í•´ ë³´ê¸° -->
    <script type="module">
        import React from "https://cdn.jsdelivr.net/npm/react@18.2.0/+esm";
        import {createRoot} from "https://cdn.jsdelivr.net/npm/react-dom@18.2.0/client/+esm";

        function CareerTypeSelector() {
            const [careerType, setCareerType] = React.useState('');

            const handleChange = (e) => {
                const value = e.target.value;
                setCareerType(value);
                document.getElementById('filter-career-type').value = value;
            };

            const container = document.getElementById('react-career-type-selector');
            if (container) {
                const root = createRoot(container);
                root.render(
                    <div className="career-type-selector">
                        <label className="me-3">
                            <input type="radio" name="careerType" value="" onChange={handleChange}
                                   checked={careerType === ''}/> ì „ì²´
                        </label>
                        <label className="me-3">
                            <input type="radio" name="careerType" value="new" onChange={handleChange}
                                   checked={careerType === 'new'}/> ì‹ ì…
                        </label>
                        <label>
                            <input type="radio" name="careerType" value="exp" onChange={handleChange}
                                   checked={careerType === 'exp'}/> ê²½ë ¥
                        </label>
                    </div>
                );
            }
        }

        CareerTypeSelector();
    </script>

</head>
<body>

<div class="wrapper">
    <div th:replace="~{fragments/header :: header(role=${role})}"></div>

    <main class="main-content container py-5">
        <h2 class="text-center mb-4">ì§€ì›ì ì´ë ¥ì„œ ëª©ë¡</h2>

        <!-- âœ… ê²€ìƒ‰ì°½ -->
        <section class="text-center mb-4">
            <input type="text" id="search-input" placeholder="ì´ë ¥ì„œ ê²€ìƒ‰" class="form-control d-inline-block w-50"/>
            <button type="button" id="search-button" class="btn btn-primary ms-2">ğŸ” ê²€ìƒ‰</button>
        </section>

        <!-- âœ… ì‹ ì…/ê²½ë ¥ í•„í„° ì˜ì—­ -->
        <!-- <section id="search-filters" class="text-center mb-4" style="display: none;">
           <label><strong>ê²½ë ¥ ìœ í˜•:</strong></label>
           <div id="react-career-type-selector" class="my-2 d-inline-block"></div>
           <input type="hidden" id="filter-career-type" />
         </section>
     -->

        <section class="search-filters text-center" id="search-filters">
            <label><strong>ì§ë¬´ ì„ íƒ:</strong></label>
            <div id="react-job-category-selector" class="mb-2"></div>
            <input type="hidden" id="filter-job-group" name="jobGroup"/>
            <input type="hidden" id="filter-job-type" name="jobType"/>
            <input type="hidden" id="filter-job-role" name="jobRole"/>

            <label><strong>ì§€ì—­ ì„ íƒ:</strong></label>
            <div id="react-location-selector" class="mb-2"></div>
            <input type="hidden" id="filter-region-main" name="region_main"/>
            <input type="hidden" id="filter-region-sub" name="region_sub"/>
        </section>


        <!-- âœ… ì´ë ¥ì„œ ì¹´ë“œ ëª©ë¡ -->
        <div class="row">
            <div class="col-md-4" th:each="resume : ${resumeList}">
                <div class="card h-100 resume-card" th:onclick="|location.href='@{/resumes/{id}(id=${resume.id})}'|"
                     style="cursor: pointer;">
                    <div class="card-body">
                        <h5 class="card-title" th:text="${resume.memberName} ?: 'ì´ë¦„ ì—†ìŒ'">ì§€ì›ì ì´ë¦„</h5>
                        <p class="card-text"><strong>ì´ë ¥ì„œ ì œëª©:</strong> <span th:text="${resume.title} ?: 'ì œëª© ì—†ìŒ'"></span>
                        </p>
                        <p class="card-text"><strong>ê¸°ìˆ  ì†Œê°œ:</strong> <span
                                th:text="${resume.skillAnswer} ?: 'ê¸°ìˆ  ì†Œê°œ ì—†ìŒ'"></span></p>
                        <p class="card-text"><strong>ì„±í–¥ ì†Œê°œ:</strong> <span
                                th:text="${resume.traitAnswer} ?: 'ì„±í–¥ ì†Œê°œ ì—†ìŒ'"></span></p>
                        <p class="card-text"><strong>ê¸°ìˆ  í‚¤ì›Œë“œ:</strong> <span
                                th:text="${resume.skillKeywords} ?: 'ê¸°ìˆ  í‚¤ì›Œë“œ ì—†ìŒ'"></span></p>
                        <p class="card-text"><strong>ì‘ì„±ì¼:</strong> <span
                                th:text="${#temporals.format(resume.createdAt, 'yyyy-MM-dd')} ?: 'ì‘ì„±ì¼ ì—†ìŒ'"></span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- âœ… í˜ì´ì§• -->
        <nav class="mt-4">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
                    <a class="page-link" th:href="@{'/resumes?page=' + (${currentPage - 1})}">ì´ì „</a>
                </li>
                <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPages)}"
                    th:classappend="${currentPage == i} ? 'active'">
                    <a class="page-link" th:href="@{'/resumes?page=' + ${i}}" th:text="${i}">1</a>
                </li>
                <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
                    <a class="page-link" th:href="@{'/resumes?page=' + (${currentPage + 1})}">ë‹¤ìŒ</a>
                </li>
            </ul>
        </nav>

    </main>

    <div th:insert="~{fragments/footer :: footer}"></div>
</div>

<!-- âœ… ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸ -->
<!--<script>-->
<!--  window.onload = function () {-->
<!--    const searchInput = document.getElementById("search-input");-->
<!--    const filterSection = document.getElementById("search-filters");-->
<!--    if (searchInput && filterSection) {-->
<!--      searchInput.addEventListener("focus", () => {-->
<!--        filterSection.style.display = "block";-->
<!--      });-->
<!--    }-->


<!--    document.getElementById("search-button").addEventListener("click", () => {-->
<!--      const companyName = document.getElementById("search-input").value;-->
<!--      const jobGroup = document.getElementById("filter-job-group").value;-->
<!--      const jobType = document.getElementById("filter-job-type").value;-->
<!--      const jobRole = document.getElementById("filter-job-role").value;-->
<!--      const regionMain = document.getElementById("filter-region-main").value;-->
<!--      const regionSub = document.getElementById("filter-region-sub").value;-->

<!--      const query = new URLSearchParams({-->
<!--        companyName: companyName || '',-->
<!--        regionMain: regionMain || '',-->
<!--        regionSub: regionSub || '',-->
<!--        jobGroup: jobGroup || '',-->
<!--        jobType: jobType || '',-->
<!--        jobRole: jobRole || ''-->
<!--      }).toString();-->

<!--      window.location.href = `/search-page?${query}`;-->
<!--    });-->
<!--  };-->
<!--</script>-->

<!-- âœ… React ëª¨ë“ˆ -->
<script th:src="@{/js/dropdown.js}"></script>
<script th:src="@{/js/logout.js}"></script>

<!-- âœ… React ì„¤ì • -->
<script type="module">
    import React from "https://cdn.jsdelivr.net/npm/react@18.2.0/+esm";
    import {createRoot} from "https://cdn.jsdelivr.net/npm/react-dom@18.2.0/client/+esm";

    window.React = React;
    window.createRoot = createRoot;
</script>

<!-- âœ… ê²½ë ¥ í•„í„° React ì»´í¬ë„ŒíŠ¸ -->
<script type="module" src="/js/JobCategorySelector.js"></script>
<!--<script type="module" src="/js/CareerTypeSelector.js"></script>-->


</body>
</html>
