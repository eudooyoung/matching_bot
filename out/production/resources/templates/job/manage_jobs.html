<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>채용 공고 관리</title>
    <link rel="stylesheet" th:href="@{/css/manage_jobs.css}">
</head>
<body>

<!-- 상단 네비게이션 -->
<div class="navbar">
    <a href="/main" class="logo">MatchingBot</a>
    <button class="nav-button">커뮤니티</button>
    <button class="nav-button" onclick="goToMyPage()">마이페이지</button>
    <span class="user-name" th:text="${company_name}"></span>
</div>

<!-- 컨테이너 -->
<div class="container">
    <h2>채용 공고 관리</h2>

    <button class="nav-button" onclick="location.href='/job/new'">공고 등록하기</button>

    <table class="job-table">
        <thead>
        <tr>
            <th>번호</th>
            <th>채용 공고 제목</th>
            <th>채용 기간</th>
            <th>상세보기</th>
            <th>수정</th>
            <th>삭제</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="job : ${jobList}">
            <td th:text="${job.id}"></td>
            <td th:text="${job.title}"></td>
            <td>
                <span th:text="${#temporals.format(job.startDate, 'yyyy-MM-dd')}">시작일</span>
                ~
                <span th:text="${#temporals.format(job.endDate, 'yyyy-MM-dd')}">종료일</span>
            </td>
            <td><a th:href="@{'/job/' + ${job.id}}">상세보기</a></td>
            <td>
                <button class="nav-button" th:onclick="|location.href='/job/${job.id}/edit'|">수정</button>
            </td>
            <td>
                <button class="delete-button" th:onclick="'deleteJob(' + ${job.id} + ')'">삭제</button>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- 삭제 스크립트 -->
<script>
    function deleteJob(id) {
        if (confirm('삭제하시겠습니까?')) {
            fetch('/job/' + id, {
                method: 'DELETE'
            })
                .then(response => {
                    if (response.ok) {
                        alert('삭제되었습니다.');
                        location.reload();
                    } else {
                        alert('삭제에 실패했습니다.');
                    }
                })
                .catch(error => {
                    console.error('삭제 중 오류:', error);
                    alert('삭제 요청 중 오류 발생!');
                });
        }
    }
</script>

</body>
</html>
